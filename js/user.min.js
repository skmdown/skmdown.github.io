var fbAppId=266003681172790;$(document).ready(function(){const userWrapper=$('#userWrapper');const pvURL=userWrapper.data('clickurl')+'/pv/';const userID=userWrapper.data('userid');const urlParams=new URLSearchParams(window.location.search);const skipPV=urlParams.get('skip_pv');if(skipPV!=='1'){$.post(pvURL,{user_id:userID});}
function setPageBg(){const bgSection=$('.user-page-section-background');const bgPortrait=bgSection.data('background-image');const bgLandscape=bgSection.data('bg-landscape');if(window.innerWidth>=window.innerHeight&&bgLandscape){bgSection.attr('data-background-image',bgLandscape);}else if(window.innerWidth<window.innerHeight&&bgPortrait){bgSection.attr('data-background-image',bgPortrait);}
window.lozad().observe();}
setPageBg();$('.save-to-contacts').click(function(e){e.stopPropagation();let firstName=$(this).data('fn');let lastName=$(this).data('ln');let organization=$(this).data('organization');let position=$(this).data('position');let email_1_type=$(this).data('email1-type');let email_1=$(this).data('email1');let email_2_type=$(this).data('email2-type');let email_2=$(this).data('email2');let phone_1_type=$(this).data('phone1-type');let phone_1=$(this).data('phone1');let phone_2_type=$(this).data('phone2-type');let phone_2=$(this).data('phone2');let country=$(this).data('country');let zip=$(this).data('zip');let street=$(this).data('street');let apt=$(this).data('apt');let city=$(this).data('city');let state=$(this).data('state');let url=$(this).data('url');let contactDetails={"version":"4.0","n":`${lastName};${firstName};;`,"fn":`${firstName} ${lastName}`,"org":`${organization}`,"title":`${position}`,"tel":[{"value":`${phone_1}`,"type":`${phone_1_type}`},{"value":`${phone_2}`,"type":`${phone_2_type}`},],"email":[{"value":`${email_1}`,"type":`${email_1_type}`},{"value":`${email_2}`,"type":`${email_2_type}`},],"url":`${url}`,"adr":[{"value":`;;${street} ${apt};${city};${state};${zip};${country}`,"type":"work"}]}
vCard.export(contactDetails,`Contact info ${firstName} ${lastName}`,true);});const DROPDOWN_ITEM=$('.dd-wrapper');$(DROPDOWN_ITEM).click(function(){const dd_item_id=$(this).data('id');$('.expand-button-icon[data-id="'+dd_item_id+'"]').toggleClass('minus');$('.expand-button-icon[data-id="'+dd_item_id+'"]').toggleClass('plus');$('.sub-item-wrapper-text[data-id="'+dd_item_id+'"]').toggleClass('hidden');})
const CURRENT_TAB=$('.tab-book-format');const LINK_ID=$(this).data('id');let bookFormat=$('.retailer-wrapper').data('book-format');$('.tab-book-format:first','.format-tabs-wrapper').addClass('active');$('.retailer-item-wrapper').each(function(){let itemRetailerBookFormat=$(this).data('retailer-book-type');if(bookFormat==itemRetailerBookFormat){$('.retailer-item-wrapper[data-retailer-book-type = '+bookFormat+']').removeClass('hidden');$('.retailer-item-wrapper[data-retailer-book-type != '+bookFormat+']').addClass('hidden');}});CURRENT_TAB.click(function(e){let currentBookFormat=$(this).data('book-format');let bookLinkId=$(this).data('id');e.stopPropagation();$(this).addClass('active').siblings().removeClass('active');$('.current-format[data-id='+bookLinkId+']').text($(this).text());$('.retailer-item-wrapper').each(function(){let itemRetailerBookFormat=$(this).data('retailer-book-type');if(currentBookFormat==itemRetailerBookFormat){$('.retailer-item-wrapper[data-retailer-book-type = '+currentBookFormat+'][data-id ='+bookLinkId+']').removeClass('hidden');$('.retailer-item-wrapper[data-retailer-book-type != '+currentBookFormat+'][data-id ='+bookLinkId+']').addClass('hidden');}});});function bookFormatsDropdownOpen(dropdownId){$(`#${dropdownId}`).toggleClass('active');$(`#${dropdownId}`).children('.popup-window').slideDown(800);}
$('.format-selector').click(function(e){e.stopPropagation();bookFormatsDropdownOpen($(this).data('id'));});$(".see-more-btn").click(function(e){let dataID=$(this).data('id');e.stopPropagation();$(".book-description[data-id='"+dataID+"']").css("max-height","none");$(".see-less-btn[data-id='"+dataID+"']").toggleClass('hidden');$(this).toggleClass('hidden');});$('.see-less-btn').click(function(e){let dataID=$(this).data('id');e.stopPropagation();$(".book-description[data-id='"+dataID+"']").css("max-height","4.5em");$(".see-more-btn[data-id='"+dataID+"']").toggleClass('hidden');$(this).toggleClass('hidden');})
$('.nft-slider-wrapper').slick({accessibility:true,arrows:true,dots:true,infinite:true,speed:300,slidesToShow:1,fade:true,autoplay:false,}).on('setPosition');$(window).scroll(function(){if($(window).scrollTop()>150){$('.shortcut__component').removeClass('hidden');$('.shortcut__component').addClass('active');}
else{$('.shortcut__component').addClass('hidden');$('.shortcut__component').removeClass('active');}});function shortcutDropdownOpen(dropdownId){$(dropdownId).toggleClass('active');$('.popup-share').slideDown(800);}
$('#messageIcon').click(function(e){shortcutDropdownOpen('#dropdownMessage');});$('#subscribeIcon').click(function(e){shortcutDropdownOpen('#dropdownSubscribe');});$('#shareIcon').click(function(e){shortcutDropdownOpen('#dropdownShare');});$('.share-item[data-type="qr"]').click(function(e){shortcutDropdownOpen('#dropdownQR');$('#dropdownShare').removeClass('active');})
$('#qrCodeIconDropdown').click(function(e){shortcutDropdownOpen('#dropdownQR');$('#dropdownShare').removeClass('active');})
if($('.flash-message').hasClass('active')){$('body').css({overflow:'hidden'});}
$('.btn-close-popup').click(function(e){let priorityClass=$(this).closest('.preview-link-item__component').data('priority-class');e.stopPropagation();$('.social-items').addClass('social-items-hidden');$('.social-button-hidden').removeClass('hidden');$('.dropdown-footer').removeClass('share-dropdown-footer-hidden');$(this).closest('.preview-link-item__component').addClass(priorityClass);$('.dropdown-popup').removeClass('active');$('.popup-window').slideUp(800);$('body').css({overflow:''});});let tab=$('.subscribe-tabs .tabs-items > div');tab.hide().filter(':first').show();$('.subscribe-tabs .tabs-nav a').click(function(){tab.hide();tab.filter(this.hash).show();$('.subscribe-tabs .tabs-nav a').removeClass('active');$(this).addClass('active');return false;}).filter(':first').click();function socialMediaShare(type,url){var target='_blank';var iframeParams='menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=300,width=600';switch(type){case'fb':var baseFbUrl='https://www.facebook.com/sharer/sharer.php?app_id=';window.open(baseFbUrl+fbAppId+'&u='+encodeURI(url)+'&href='+encodeURI(url)+'&t='+encodeURI(document.title),target,iframeParams);break;case'tw':var baseTwUrl='https://twitter.com/share?url=';window.open(baseTwUrl+encodeURI(url)+'&text='+encodeURI(document.title),target,iframeParams);break;case'telegram':var baseTgUrl='https://t.me/share/url?url=';window.open(baseTgUrl+encodeURI(url)+'&text='+encodeURI(document.title),target,iframeParams);break;case'linkedin':var baseLdUrl='https://www.linkedin.com/shareArticle?mini=true&url=';window.open(baseLdUrl+encodeURI(url)+'&title='+encodeURI(document.title)+'&source='+'',target,iframeParams);break;return null;}}
$('.share-item').click(function(){let dataType=$(this).data('type');let shareurl=$(this).data('shareurl');socialMediaShare(dataType,shareurl);return false;});$('.share-item[data-type="email"]').click(function(){let shareurl=$(this).data('shareurl');let mailto=`mailto: ?subject=HeyLink.me&body=${shareurl}`;window.location.href=mailto;});$('.social-button-hidden').click(function(){$('.social-items').removeClass('social-items-hidden');$('.social-button-hidden').addClass('hidden');$('.dropdown-footer').addClass('share-dropdown-footer-hidden');})
$('.btn-png').click(function(){let downloadImage=$(this).data('image');let downloadImageReady;fetch(downloadImage).then(res=>res.blob()).then(blob=>(downloadImageReady=blob)).then(()=>{download(downloadImageReady,'qrcode-heylinkme-profile',downloadImageReady.type);})});const requiredValidationError=$('#i18n-validation-required').text();const errorElement=$('.validation-error-shortcut');$('form[data-action="ShortcutSubscribeGenerator"]').each(function(index){let subscriptionForm=$(this);let id=$(this).data('id');subscriptionForm.validate({errorElement:'div',errorClass:'validation-error-shortcut',rules:{value:{required:true,}},messages:{value:{required:requiredValidationError,},},submitHandler:function(form,params){const subscriptionType=subscriptionForm.find('input').data('type');const subscriptionInput=subscriptionForm.find('input').val();const ownerUsername=subscriptionForm.data('username');const formId=subscriptionForm.data('id');const errorElement=subscriptionForm.find('.validation-error-shortcut[data-id='+id+']');const successMessage=subscriptionForm.data('success-message');$.ajax({type:form.method,dataType:'json',contentType:'application/json',url:form.action,data:JSON.stringify({"value":subscriptionInput,"signup_type":subscriptionType,"username":ownerUsername,}),success:function(data){if(data.status==="ok"){$('form[data-id='+formId+']').css({'display':'none'})
$('.result-message[data-id='+formId+']').css({'display':'block'});}},error:function(data){if(data.responseJSON){errorElement.fadeIn().text(data.responseJSON.error);}}});}});});const phoneValidationError=$('#i18n-validation-phone').text();const emailValidationError=$('#i18n-validation-email').text();const tooLongValidationError=$('#i18n-validation-too-long').text();if($('form#anonymousMessageShortcutForm').length){let isNameRequired=false;let isEmailRequired=false;let isEmailValid=false;let isPhoneRequired=false;let isCustomField1Required=false;let isCustomField2Required=false;let isCustomField3Required=false;$.validator.addMethod('phone_number',function(value,element){return this.optional(element)||/^\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/.test(value);},phoneValidationError);if($("#shortcutAnonymousMessagesNameInput").length&&$("#shortcutAnonymousMessagesNameInput").data('required').toLowerCase()==='true'){isNameRequired=true;}
if($("#shortcutAnonymousMessagesEmailInput").length&&$("#shortcutAnonymousMessagesEmailInput").data('required').toLowerCase()==='true'){isEmailRequired=true;}
if($("#shortcutAnonymousMessagesPhoneInput").length&&$("#shortcutAnonymousMessagesPhoneInput").data('required').toLowerCase()==='true'){isPhoneRequired=true;}
if($("#shortcutAnonymousMessagesCustomField1Input").length&&$("#shortcutAnonymousMessagesCustomField1Input").data('required').toLowerCase()==='true'){isCustomField1Required=true;}
if($("#shortcutAnonymousMessagesCustomField2Input").length&&$("#shortcutAnonymousMessagesCustomField2Input").data('required').toLowerCase()==='true'){isCustomField2Required=true;}
if($("#shortcutAnonymousMessagesCustomField3Input").length&&$("#shortcutAnonymousMessagesCustomField3Input").data('required').toLowerCase()==='true'){isCustomField3Required=true;}
if($("#shortcutAnonymousMessagesEmailInput").length){$('#shortcutAnonymousMessagesEmailInput').on('keyup paste',function(e){let input=$(this).val();if(input.length>0){$("#shortcutAnonymousMessagesEmailInput").rules("add",{email:true,});}});}
$('form#anonymousMessageShortcutForm').validate({errorElement:'div',errorClass:'validation-error',rules:{message:{required:true,maxlength:512,},name:{required:isNameRequired,maxlength:255,},email:{required:isEmailRequired,email:true,maxlength:254,},phone:{phone_number:true,minlength:10,maxlength:16,required:isPhoneRequired,},custom_field1:{required:isCustomField1Required,maxlength:225,},custom_field2:{required:isCustomField2Required,maxlength:225,},custom_field3:{required:isCustomField3Required,maxlength:225,},},messages:{email:{email:emailValidationError,required:requiredValidationError,maxlength:tooLongValidationError,},name:{required:requiredValidationError,maxlength:tooLongValidationError,},message:{required:requiredValidationError,maxlength:tooLongValidationError,},phone:{phone_number:phoneValidationError,required:requiredValidationError,maxlength:tooLongValidationError,},custom_field1:{required:requiredValidationError,maxlength:tooLongValidationError,},custom_field2:{required:requiredValidationError,maxlength:tooLongValidationError,},custom_field3:{required:requiredValidationError,maxlength:tooLongValidationError,},},submitHandler:function(form,params){const messageForm=form;const message=$('#shortcutAnonymousMessageTextArea').val();const username=$(messageForm).data('username');let nameField=null;let emailField=null;let phoneField=null;let customField1=null;let customField2=null;let customField3=null;if($("#shortcutAnonymousMessagesNameInput").length){nameField=$("#shortcutAnonymousMessagesNameInput").val();}
if($("#shortcutAnonymousMessagesEmailInput").length){emailField=$("#shortcutAnonymousMessagesEmailInput").val();}
if($("#shortcutAnonymousMessagesPhoneInput").length){phoneField=$("#shortcutAnonymousMessagesPhoneInput").val();}
if($("#shortcutAnonymousMessagesCustomField1Input").length){customField1=$("#shortcutAnonymousMessagesCustomField1Input").val();}
if($("#shortcutAnonymousMessagesCustomField2Input").length){customField2=$("#shortcutAnonymousMessagesCustomField2Input").val();}
if($("#shortcutAnonymousMessagesCustomField3Input").length){customField3=$("#shortcutAnonymousMessagesCustomField3Input").val();}
$.ajax({type:form.method,dataType:'json',contentType:'application/json',url:form.action,data:JSON.stringify({"message":message,"username":username,"name":nameField,"email":emailField,"phone":phoneField,"custom_field1":customField1,"custom_field2":customField2,"custom_field3":customField3}),success:function(data){if(data.status==="ok"){$('#anonymousMessageShortcutForm').css({'display':'none'})
$('.shortcut-anonymous-msg-success-message').css({'display':'block'})}},error:function(data){if(data.responseJSON){var key=Object.keys(data.responseJSON)[0];if(key==='message'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesTextInput-error');}else if(key==='email'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesEmailInput-error');}else if(key==='phone'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesPhoneInput-error');}else if(key==='custom_field1'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesCustomField1Input-error');}else if(key==='custom_field2'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesCustomField2Input-error');}else if(key==='custom_field3'){var errorElement=$('#anonymousMessageShortcutForm #shortcutAnonymousMessagesCustomField3Input-error');}
errorElement.fadeIn().text(data.responseJSON[key]);}}});}});}
$('#shortcutAnonymousMessageTextArea').on('keyup paste',function(e){let input=$(this).val(),inputLength=input.length,maxCharacters=512,remain=parseInt(maxCharacters-inputLength);$('#shortcutAnonymousMessagesTextInputMaxCharacters i').text(remain);if(remain<=0&&e.which!==0&&e.charCode!==0){$('#shortcutAnonymousMessageTextArea').val((input).substring(0,inputLength-1))}});const SORT_TAB=$('.sort');const DROPDOWN_SORT_OPTIONS=$('.dropdown-list-options');const FILTER_BTN=$('.filter');const DROPDOWN_FILTER_OPTIONS=$('.dropdown-filter-options');let sortIsOpen=false;let filterIsOpen=false;SORT_TAB.click(function(){if(!sortIsOpen){DROPDOWN_SORT_OPTIONS.slideDown();}else{DROPDOWN_SORT_OPTIONS.slideUp();}
sortIsOpen=!sortIsOpen;});FILTER_BTN.click(function(){if(!filterIsOpen){DROPDOWN_FILTER_OPTIONS.slideDown();}else{DROPDOWN_FILTER_OPTIONS.slideUp();}
filterIsOpen=!filterIsOpen;});$(".custom-sort-option").click(function(){let orderingValue=$(this).data('value');let itemList=$(".store-link-item");let currentText=$(this).text();if(orderingValue==='default'){itemList.sort(function(a,b){return $(a).data("ordering")-$(b).data("ordering");});}else if(orderingValue==='price_asc'){itemList.sort(function(a,b){return $(a).data("price")-$(b).data("price");});}else if(orderingValue==='price_desc'){itemList.sort(function(a,b){return $(b).data("price")-$(a).data("price");});}else if(orderingValue==='name_asc'){itemList.sort(function(a,b){return String.prototype.localeCompare.call($(a).data('name').toLowerCase(),$(b).data('name').toLowerCase());});}else if(orderingValue==='name_desc'){itemList.sort(function(a,b){return String.prototype.localeCompare.call($(b).data('name').toLowerCase(),$(a).data('name').toLowerCase());});}
$("#extendedProductsWrapper").html(itemList);$(".current-sort-tab").text(currentText);sortIsOpen=!sortIsOpen;DROPDOWN_SORT_OPTIONS.slideUp();});$(".custom-filter-option").click(function(){let filterValue=$(this).data('value');let currentFilterText=$(this).text();if(filterValue==='all'){$('.store-link-item').fadeIn();}else{$('.store-link-item').hide();$('.store-link-data[data-value="'+filterValue+'"]').parent().fadeIn();}
let numberOfVisibleElements=$('#extendedProductsWrapper').children().filter(function(){return $(this).css("display")!="none";}).length;if(numberOfVisibleElements===0){DROPDOWN_FILTER_OPTIONS.css({'position':'absolute','left':'0','right':'0','top':'-220px'});DROPDOWN_SORT_OPTIONS.css({'position':'absolute','left':'0','right':'0','top':'-160px'});}else if(numberOfVisibleElements!==0){DROPDOWN_FILTER_OPTIONS.css({'position':'absolute','left':'0','right':'0','top':'45px'});DROPDOWN_SORT_OPTIONS.css({'position':'absolute','left':'0','right':'0','top':'45px'});}
DROPDOWN_FILTER_OPTIONS.slideUp();filterIsOpen=!filterIsOpen;$('.current-filter-tab').text(currentFilterText);});$(document).mouseup(function(e){let container=$(".sort-dropdown-wrapper");if(!container.is(e.target)&&container.has(e.target).length===0){if(sortIsOpen){DROPDOWN_SORT_OPTIONS.slideUp();sortIsOpen=!sortIsOpen;}}});$(document).mouseup(function(e){let container=$(".filter-dropdown-wrapper");if(!container.is(e.target)&&container.has(e.target).length===0){if(filterIsOpen){DROPDOWN_FILTER_OPTIONS.slideUp();filterIsOpen=!filterIsOpen;}}});let promoImages={"imageURLS":["/static/img/promo_images/promo_img_1.svg","/static/img/promo_images/promo_img_2.svg","/static/img/promo_images/promo_img_3.svg","/static/img/promo_images/promo_img_4.svg","/static/img/promo_images/promo_img_5.svg","/static/img/promo_images/promo_img_6.svg","/static/img/promo_images/promo_img_7.svg","/static/img/promo_images/promo_img_8.svg",]};let randomIndex=Math.floor(Math.random()*promoImages.imageURLS.length);let randomImageUrl=promoImages.imageURLS[randomIndex];$('.heylink-promo-img').attr('src',randomImageUrl);$('.more-less-btn').click(function(){let $this=$(this);let $content=$this.prev('.podcast-description');$content.toggleClass('description-expanded');if($content.hasClass('description-expanded')){$(this).text('See less');}else{$(this).text('See more');}});$('.see-all-platforms-button').click(function(){let $this=$(this);let $content=$this.closest('.platforms-wrapper').find('.items-wrapper');$content.toggleClass('items-wrapper-expanded');if($content.hasClass('items-wrapper-expanded')){$(this).text('See less platforms');}else{$(this).text('See all platforms');}});$('.recent-episode').click(function(e){e.stopPropagation();let $this=$(this);if(!$this.hasClass('open')){$('.recent-episode.open').removeClass('open').find('.recent-episode-services').slideUp(600);$this.addClass('open').find('.recent-episode-services').slideDown(600);}else{$this.removeClass('open').find('.recent-episode-services').slideUp(600);}});});