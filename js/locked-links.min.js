$(document).ready(function(){$(function(_e){const $THIS=$(_e.currentTarget);const LINK_ID=$THIS.data('id');const currentYear=new Date().getFullYear();$('.lock-datapicker').datepicker({changeMonth:true,changeYear:true,yearRange:`1945:${currentYear}`,dateFormat:'dd/mm/yy',});});function showFirstHiddenChildElement(classElement){var foundHidden=false;$('.common-expanded-locked-block__component').children().each(function(){if($(this).css('display')==='none'){$(classElement).remove();$(this).show();foundHidden=true;return false;}});if(!foundHidden){location.reload();}}
function getVisitorUUID(){let visitorUUID=null;$.each(document.cookie.split('; '),function(index,cookie){const[name,value]=cookie.split('=');if(name==='visitor_uuid'){visitorUUID=value;return false;}});return visitorUUID;}
$('.preview-lock-link-item__component').click(function(e){let $this=$(e.currentTarget);let typeLinkID=$this.data('id');let priorityClass=$this.data('priority-class');let isExpanded=$this.data('is-expanded');if($(e.target).closest('.common-expanded-locked-block__component').is('.common-expanded-locked-block__component'))return;$('.common-expanded-locked-block__component[data-id="'+typeLinkID+'"]').toggleClass('hidden');$('.preview-lock-link-wrapper[data-id="'+typeLinkID+'"]').toggleClass('bottom-border-radius');if(isExpanded&&priorityClass){$this.addClass(priorityClass)}
if($this.hasClass('buzz')||$this.hasClass('pop')||$this.hasClass('wobble')){$this.removeClass('buzz pop wobble');}
if($this.hasClass('active')&&priorityClass){$this.addClass(priorityClass)}
$this.toggleClass('active');});$('.continue-sensitive-btn').click(function(_e){const $THIS=$(_e.currentTarget);const API_URL=$THIS.data('apiurl');const LINK_ID=$THIS.data('id');const visitorUUID=getVisitorUUID();console.log(visitorUUID);$.ajax({type:'POST',dataType:'json',url:`${API_URL}/api/v1/links/unlock/`,data:{link_id:LINK_ID,feature:'locked_link',action:'sensitive',confirmed:true,visitor_uuid:visitorUUID,},success:function(response){document.cookie=`visitor_uuid=${response.uuid}`;showFirstHiddenChildElement($('.lock-sensitive-content__component'));},error:function(textStatus){console.log(textStatus);},});});$('.continue-code-btn').click(function(_e){var codeValue=$('.code-input').val();const $THIS=$(_e.currentTarget);const API_URL=$THIS.data('apiurl');const LINK_ID=$THIS.data('id');const visitorUUID=getVisitorUUID();console.log(visitorUUID);$.ajax({type:'POST',dataType:'json',contentType:'application/json',url:`${API_URL}/api/v1/links/unlock/`,data:JSON.stringify({link_id:LINK_ID,feature:'locked_link',action:'code',data:{code:codeValue},visitor_uuid:visitorUUID,}),success:function(response){document.cookie=`visitor_uuid=${response.uuid}`;showFirstHiddenChildElement($('.lock-code__component'));},error:function(textStatus){console.log(textStatus.statusText);$('.code-input').after('<div class="error-message" style="color: red">Unlock failed! Please enter true code!</div>');},});});$('.continue-age-btn').click(function(_e){let dateOfBirth=$('.lock-datapicker').val();const $THIS=$(_e.currentTarget);const API_URL=$THIS.data('apiurl');const LINK_ID=$THIS.data('id');let parts=dateOfBirth.split('/');let day=parts[0];let month=parts[1];let year=parts[2];const visitorUUID=getVisitorUUID();console.log(visitorUUID);$.ajax({type:'POST',dataType:'json',contentType:'application/json',url:`${API_URL}/api/v1/links/unlock/`,data:JSON.stringify({link_id:LINK_ID,feature:'locked_link',action:'min_age',data:{year:year,month:month,day:day},visitor_uuid:visitorUUID,}),success:function(response){document.cookie=`visitor_uuid=${response.uuid}`;showFirstHiddenChildElement($('.lock-age__component'));},error:function(textStatus){console.log(textStatus.statusText);$('.lock-datapicker').after('<div class="error-message" style="color: red">'+'You can not access this content because you have not met the minimum age requirement.'+'</div>');},});});});